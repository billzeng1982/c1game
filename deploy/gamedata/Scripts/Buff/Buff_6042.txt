--[[
名称：五行之术
类型：被动buff
描述：增加友军冰、火、雷元素属性的技能伤害（甄姬、庞统、张角、孙策、小乔、陆逊、周瑜、诸葛亮）
--]]
local ThisScriptId = 6042;
 
 --Buff诞生处理
local function runBorn(LuaDataAgt)
	LuaDataAgt:SetBuffLifeTime(VALUE_TYPE.RUNTIME_CONF, 999);
	
	LuaDataAgt:SetFilter(FILTER_TYPE.HP, TARGET_GROUP.NONE, 0);
end

--Buff驱散条件判断
 local function checkDeadCond(LuaDataAgt)
	
	return false;
end

--Buff驱散生效
local function runDead(LuaDataAgt)
	
end
	
--Buff生效条件判断
local function checkEffectCond(LuaDataAgt)
	return true;
end	

-- Buff生效
local function takeEffect(LuaDataAgt)

end 
--技能过滤
local function doFilter(LuaDataAgt, iFilterType, rFilterOwner, FilterValue)
	-- Filter所有者是否是发起对象
	local IsSource = rFilterOwner:Equal(FilterValue:GetSource());
	
	if iFilterType == FILTER_TYPE.HP and FilterValue.m_iValueChgType == VALUE_CHG_TYPE.CHG_HP_GENERALSKILL then
		local iHp = FilterValue.m_fFoo1;
		
		--判断是否为骑兵造成的伤害
		if (iHp < 0 and IsSource) then 
			if (FilterValue.m_iValueChgPara == 20 or
				--FilterValue.m_iValueChgPara == 26 or
				FilterValue.m_iValueChgPara == 4 or
				FilterValue.m_iValueChgPara == 6 or
				FilterValue.m_iValueChgPara == 21 or
				FilterValue.m_iValueChgPara == 23 or
				FilterValue.m_iValueChgPara == 71 or
				FilterValue.m_iValueChgPara == 3 or
				FilterValue.m_iValueChgPara == 17) then --判断是否为目标武将技能造成的伤害
				
				local rSource = LuaDataAgt:GetBuffSource();
				local Ratio = rSource:GetPassiveSkillBaseValue(ThisScriptId, 1) / 100;
		
				FilterValue.m_fFoo1 = iHp * (1 + Ratio);  --对伤害进行处理
			end
		end
	end
	
	return FilterValue;
end

Buff_6042 = {
	func_runBorn = runBorn;
	func_checkDeadCond = checkDeadCond;
	func_runDead = runDead;
	func_checkEffectCond = checkEffectCond;
	func_takeEffect = takeEffect;
	func_doFilter = doFilter;
}