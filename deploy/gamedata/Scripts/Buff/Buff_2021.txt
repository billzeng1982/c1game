--[[
名称：霸王雷破
类型：主动技能
描述：自身加速
--]]
local ThisScriptId = 2021;

--Buff诞生处理
local function runBorn(LuaDataAgt)
	-- 添加血量过滤处理
	--LuaDataAgt:SetFilter(FILTER_TYPE.HP, TARGET_GROUP.NONE, 3);

	local rSource = LuaDataAgt:GetBuffSource();
	--buff时间
	local itime = rSource:GetActiveSkillBaseValue(4);
	LuaDataAgt:SetBuffLifeTime(VALUE_TYPE.RUNTIME_CONF, itime);
	--加速
	local iSpeed = rSource:GetActiveSkillAdditionValue(3);
	LuaDataAgt:ChgSpeedByRatio( - 1 + iSpeed / 100);
	
end

--Buff驱散条件判断
local function checkDeadCond(LuaDataAgt)
	
	
	return false;
end

--Buff驱散生效
local function runDead(LuaDataAgt)
	--属性加减回退
	--设置BUFF速度
	local rSource = LuaDataAgt:GetBuffSource();
	local iSpeed = rSource:GetActiveSkillAdditionValue(3);
	LuaDataAgt:ChgSpeedByRatio( 1 - iSpeed / 100);
end

--Buff生效条件判断
local function checkEffectCond(LuaDataAgt)
	return true;
end

--Buff生效
local function takeEffect(LuaDataAgt)

	
end

--Buff过滤处理
--[[
local function doFilter(LuaDataAgt, iFilterType, rFilterOwner, FilterValue)
	-- Filter所有者是否是发起对象
	local IsSource = rFilterOwner:Equal(FilterValue:GetSource());
	local rSource = LuaDataAgt:GetBuffSource();
	local iHp = FilterValue.m_fFoo1;
	
	if iFilterType == FILTER_TYPE.HP then
		local iHp = FilterValue.m_fFoo1;
		if iHp < 0 and IsSource then
			if (FilterValue.m_iValueChgType == VALUE_CHG_TYPE.CHG_HP_ATK_SHOOT or
				FilterValue.m_iValueChgType == VALUE_CHG_TYPE.CHG_HP_ATK_SPEAR or
				FilterValue.m_iValueChgType == VALUE_CHG_TYPE.CHG_HP_ATK_NORMAL or
				FilterValue.m_iValueChgType == VALUE_CHG_TYPE.CHG_HP_ATK_RUSH or
				FilterValue.m_iValueChgType == VALUE_CHG_TYPE.CHG_HP_ATK_FACE or
				FilterValue.m_iValueChgType == VALUE_CHG_TYPE.CHG_HP_ATK_AMBUSH ) then
				
				local Count = LuaDataAgt:GetShareValue(1);
				if Count == 1 then
					LuaDataAgt:SetShareValue(1, 0);
					
					FilterValue.m_fFoo1 = iHp * 2;
					
					if not IsOnServer then
						local TarPos = LuaDataAgt:GetCurPos();
						LuaDataAgt:PlayFX("Prefabs/BasicEffect/3D_CharEff_BaoJi", LuaDataAgt, TarPos, TarPos, 0, true);
					end
				end
			end		
		end
	end
	
	return FilterValue;
    
end
]]

--Buff公式处理
local function doFormula(LuaDataAgt, iFormulaType, iFormulaPara, rSource, rTarget, iDamageRef)

end

Buff_2021 = {
	func_runBorn = runBorn;
	func_checkDeadCond = checkDeadCond;
	func_runDead = runDead;
	func_checkEffectCond = checkEffectCond;
	func_takeEffect = takeEffect;
	
	func_doFilter = doFilter;
	--func_doFormula = doFormula;
}