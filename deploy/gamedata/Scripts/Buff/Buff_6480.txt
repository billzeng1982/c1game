--[[
名称:计如泉涌
类型:被动技能
描述:每次成功施法后，会降低对手物防和法防(此被动技能为空，技能效果写在同idbuff里，触发写在郭嘉主动技中id48)
--]]
local ThisScriptId = 6480;

--Buff诞生处理
local function runBorn(LuaDataAgt)
	local rsource = LuaDataAgt:GetBuffSource();
	
	--属性加减
	local Def = rsource:GetPassiveSkillBaseValue(ThisScriptId, 1);
	LuaDataAgt:ChgWitDef(VALUE_TYPE.CURRENT, -Def);
	LuaDataAgt:ChgStrDef(VALUE_TYPE.CURRENT, -Def);

	if not IsOnServer then
		LuaDataAgt:RefreshFightNum();
		
		local TarPos = LuaDataAgt:GetCurPos();
		--LuaDataAgt:Play2DFXFollowTroopInfo("Prefabs/BasicEffect/UI_CharEff_WuFangXiaJiang", 2 , TarPos);
		--LuaDataAgt:Play2DFXFollowTroopInfo("Prefabs/BasicEffect/UI_CharEff_FaFangXiaJiang", 2.5 , TarPos);
		LuaDataAgt:PlayFX("Prefabs/BasicEffect/3D_CharEff_WuFangXiaJiang", LuaDataAgt, TarPos, TarPos, 2, true);
		LuaDataAgt:PlayFX("Prefabs/BasicEffect/3D_CharEff_FaFangXiaJiang", LuaDataAgt, TarPos, TarPos, 2.5, true);
	end
end

--Buff驱散条件判断
local function checkDeadCond(LuaDataAgt)

	return false;
end

--Buff驱散生效
local function runDead(LuaDataAgt)
	--属性加减
	local rsource = LuaDataAgt:GetBuffSource();
	
	local level = rsource:GetPassiveSkillLevel(ThisScriptId);
	
	if level ~= 0 then
		local Def = rsource:GetPassiveSkillBaseValue(ThisScriptId, 1);
		LuaDataAgt:ChgWitDef(VALUE_TYPE.CURRENT, Def);
		LuaDataAgt:ChgStrDef(VALUE_TYPE.CURRENT, Def);

		if not IsOnServer then
			LuaDataAgt:RefreshFightNum();
		end
	end
end

--Buff生效条件判断
local function checkEffectCond(LuaDataAgt)
	return true;
end

--Buff生效
local function takeEffect(LuaDataAgt)

end

Buff_6480 = {
	func_runBorn = runBorn;
	func_checkDeadCond = checkDeadCond;
	func_runDead = runDead;
	func_checkEffectCond = checkEffectCond;
	func_takeEffect = takeEffect;
}
