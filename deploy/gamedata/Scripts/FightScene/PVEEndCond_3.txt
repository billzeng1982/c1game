--[[
名称：PVE BOSS关卡使用
返回值：是否结束，胜利方，结束原因
描述：
1、我方血量小于0，失败
2、我方部队全部死亡，失败
3、敌方部队全部死亡，胜利
4、敌方BOSS全部死亡，胜利
5、时间到，失败
--]]

local function checkPVEEndCond(LuaFightController)
	--判断是否结束
	local bIsEnd = false;
	local eWiner = PLAYER_GROUP.PLAYER_GROUP_NONE;
	local eReason = FIGHTSETTLE_REASON.FIGHTSETTLE_NONE;
	local iSelfHP = LuaFightController:GetCityHpSelf();
	local iEnemyHP = LuaFightController:GetCityHpEnemy();
	local iLeftTime = LuaFightController:GetCurFightTime();
	local iIsSelfDeadAll = LuaFightController:IsSelfDeadAll();
	local iIsEnemyDeadAll = LuaFightController:IsEnemyDeadAll();
	local iIsEnemyDeadAllBoss = LuaFightController:IsEnemyDeadAllBoss();
	
	--判断胜负方，策划可以修改
	if iSelfHP <= 0 then
		bIsEnd = true;
		eWiner = PLAYER_GROUP.PLAYER_GROUP_UP;
		eReason = FIGHTSETTLE_REASON.FIGHTSETTLE_CITYBREAK;
		
	elseif iIsSelfDeadAll == true then
		bIsEnd = true;
		eWiner = PLAYER_GROUP.PLAYER_GROUP_UP;
		eReason = FIGHTSETTLE_REASON.FIGHTSETTLE_ROUNDFAIL;
	
	elseif iIsEnemyDeadAll == true then
		bIsEnd = true;
		eWiner = PLAYER_GROUP.PLAYER_GROUP_DOWN;
		eReason = FIGHTSETTLE_REASON.FIGHTSETTLE_BOSSDEAD;
		
	elseif iIsEnemyDeadAllBoss == true then
		bIsEnd = true;
		eWiner = PLAYER_GROUP.PLAYER_GROUP_DOWN;
		eReason = FIGHTSETTLE_REASON.FIGHTSETTLE_BOSSDEAD;
	
	elseif iLeftTime <= 0 then
		bIsEnd = true;
		eWiner = PLAYER_GROUP.PLAYER_GROUP_UP;
		eReason = FIGHTSETTLE_REASON.FIGHTSETTLE_TIMEOVER;
		
	end
	
	return bIsEnd, eWiner, eReason;
end

PVEEndCond_3 = {
	func_PVEEndCond = checkPVEEndCond;
}